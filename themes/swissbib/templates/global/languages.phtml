<?php
$langConfig  = array(
    'de'    => 'Deutsch',
    'en'    => 'English',
    'fr'    => 'FranÃ§ais',
    'it'    => 'Italiano'
);

$languages  = array();
$keySelectedLanguage    = array_key_exists('lng', $_GET) ? $_GET['lng'] : 'de';

foreach($langConfig as $key => $label) {
    $languages[] = array(
        'key'       => $key,
        'label'     => $label,
        'selected'  => $keySelectedLanguage == $key
    );
}
?>

<div id="meta">
	<h3 class="hidden">Metanavigation</h3>
	<ul>
		<?php foreach($languages as $lang): ?>
		<li class="nav_<?=$lang['key']?><?= $lang['selected'] ? ' selected' : '' ?>">
<?
    $url = $this->serverUrl(true);
    $pattern    = '/lng\=[a-z]+/';
    $replace    = 'lng=' . $lang['key'];
    $url        = preg_replace($pattern, $replace, $url);
?>
			<a href="<?=$url?>" title="<?=$lang['label']?>"><?=$lang['key']?></a>
		</li>
		<?php endforeach; ?>
	</ul>
</div>